{% extends "base.html" %}

{% block title %}Cycle Swapping - Rutgers Room Swap{% endblock %}

{% block content %}
<div class="form-section">
    <div id="welcomeMessage" style="text-align: center; margin-bottom: 30px; padding: 20px; background: rgba(255, 255, 255, 0.1); border-radius: 10px;">
        <h1 style="color: #ffff99; margin-bottom: 10px;">Welcome, <span id="userDisplayName">User</span>!</h1>
        <p style="color: #ffdddd; font-size: 1.1rem;">Create a cycle swap request that tries direct swaps first, then expands to chain swaps!</p>
    </div>

    <h2>Your Cycle Swap Request</h2>
    
    <!-- User Request Section -->
    <div id="cycleUserRequestSection">
        <div id="cycleNoRequest" style="text-align: center; color: #ffcccc;">
            <p style="margin-bottom: 20px;">You haven't posted a cycle swap request yet.</p>
            <button class="btn" onclick="showCycleCreateForm()" id="createCycleRequestBtn">Create Cycle Swap Request</button>
        </div>
        
        <div id="cycleHasRequest" style="display: none;">
            <div id="cycleUserRequestCard" class="listing-card">
                <!-- User's cycle request will be displayed here -->
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="showCycleEditForm()" id="editCycleRequestBtn">Edit Cycle Swap Request</button>
                <button class="btn btn-danger" onclick="deleteCycleRequest()" id="deleteCycleRequestBtn">Delete Cycle Swap Request</button>
            </div>
        </div>
    </div>
</div>

<div class="form-section">
    <h2>How Cycle Swapping Works</h2>
    <div style="background: rgba(255, 255, 255, 0.1); padding: 20px; border-radius: 10px;">
        <div style="margin-bottom: 15px;">
            <h3 style="color: #ffff99; margin-bottom: 10px;">Step 1: Try Direct 2-Way Swap</h3>
            <p>We first look for someone who wants your current housing and has your desired housing.</p>
        </div>
        
        <div style="margin-bottom: 15px;">
            <h3 style="color: #ffff99; margin-bottom: 10px;">Step 2: Expand to 3-Way Chain</h3>
            <p>If no direct swap is found, we look for a 3-way chain where:</p>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li>Person A wants your housing</li>
                <li>Person B wants Person A's housing</li>
                <li>You want Person B's housing</li>
            </ul>
        </div>
        
        <div>
            <h3 style="color: #ffff99; margin-bottom: 10px;">Benefits</h3>
            <p>This approach maximizes your chances of finding a swap by being flexible with the matching strategy!</p>
        </div>
    </div>
</div>

<!-- Cycle Create/Edit Form -->
<div class="form-section" id="cycleCreateEditForm" style="display: none;">
    <h2 id="cycleFormTitle">Create Cycle Swap Request</h2>
    <form id="cycleForm">
        <div class="form-row">
            <div class="form-group">
                <label for="cycleCurrentApartment">Current Apartment/Dorm:</label>
                <select id="cycleCurrentApartment" name="cycleCurrentApartment" required>
                    <option value="">Select your current housing</option>
                    <option value="Davidson Hall D">Davidson Hall D</option>
                    <option value="Buell Apartments">Buell Apartments</option>
                    <option value="Frelinghuysen Apartments">Frelinghuysen Apartments</option>
                    <option value="Johnson Apartments">Johnson Apartments</option>
                    <option value="Marvin Apartments">Marvin Apartments</option>
                    <option value="Starkey Apartments">Starkey Apartments</option>
                    <option value="Silvers Apartments">Silvers Apartments</option>
                    <option value="Honors College">Honors College</option>
                    <option value="Stonier Hall">Stonier Hall</option>
                    <option value="Tinsley Hall">Tinsley Hall</option>
                    <option value="University Center at Easton Avenue">University Center at Easton Avenue</option>
                    <option value="Wessels Hall">Wessels Hall</option>
                    <option value="Leupp Hall">Leupp Hall</option>
                    <option value="Mettler Hall">Mettler Hall</option>
                    <option value="Pell Hall">Pell Hall</option>
                    <option value="Sojourner Truth Apartments">Sojourner Truth Apartments</option>
                    <option value="Helyar House">Helyar House</option>
                    <option value="Henderson Apartments">Henderson Apartments</option>
                    <option value="Jameson Hall">Jameson Hall</option>
                    <option value="Katzenbach Hall">Katzenbach Hall</option>
                    <option value="Lippincott Hall">Lippincott Hall</option>
                    <option value="New Gibbons">New Gibbons</option>
                    <option value="Newell Apartments">Newell Apartments</option>
                    <option value="Livingston Apartments">Livingston Apartments</option>
                    <option value="Lynton Towers North & South">Lynton Towers North & South</option>
                    <option value="Quad I, II, III">Quad I, II, III</option>
                </select>
            </div>
            <div class="form-group">
                <label for="cycleCurrentRoom">Current Room/Unit:</label>
                <input type="text" id="cycleCurrentRoom" name="cycleCurrentRoom" placeholder="e.g., Apt 4B, Room 302" required>
            </div>
        </div>

        <div class="form-group">
            <label for="desiredChoice">Desired Apartment/Dorm (Single Choice):</label>
            <select id="desiredChoice" name="desiredChoice" required>
                <option value="">Select desired housing</option>
                <option value="Davidson Hall D">Davidson Hall D</option>
                <option value="Buell Apartments">Buell Apartments</option>
                <option value="Frelinghuysen Apartments">Frelinghuysen Apartments</option>
                <option value="Johnson Apartments">Johnson Apartments</option>
                <option value="Marvin Apartments">Marvin Apartments</option>
                <option value="Starkey Apartments">Starkey Apartments</option>
                <option value="Silvers Apartments">Silvers Apartments</option>
                <option value="Honors College">Honors College</option>
                <option value="Stonier Hall">Stonier Hall</option>
                <option value="Tinsley Hall">Tinsley Hall</option>
                <option value="University Center at Easton Avenue">University Center at Easton Avenue</option>
                <option value="Wessels Hall">Wessels Hall</option>
                <option value="Leupp Hall">Leupp Hall</option>
                <option value="Mettler Hall">Mettler Hall</option>
                <option value="Pell Hall">Pell Hall</option>
                <option value="Sojourner Truth Apartments">Sojourner Truth Apartments</option>
                <option value="Helyar House">Helyar House</option>
                <option value="Henderson Apartments">Henderson Apartments</option>
                <option value="Jameson Hall">Jameson Hall</option>
                <option value="Katzenbach Hall">Katzenbach Hall</option>
                <option value="Lippincott Hall">Lippincott Hall</option>
                <option value="New Gibbons">New Gibbons</option>
                <option value="Newell Apartments">Newell Apartments</option>
                <option value="Livingston Apartments">Livingston Apartments</option>
                <option value="Lynton Towers North & South">Lynton Towers North & South</option>
                <option value="Quad I, II, III">Quad I, II, III</option>
            </select>
        </div>

        <div style="text-align: center; margin-top: 30px;">
            <button type="submit" class="btn" id="cycleSubmitBtn">Create Cycle Swap Request</button>
            <button type="button" class="btn btn-secondary" onclick="hideCycleForm()" style="margin-left: 10px;">Cancel</button>
        </div>
    </form>
</div>

<script src="{{ url_for('static', filename='js/dashboard-utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/cycle-swapping.js') }}"></script>
{% endblock %} 